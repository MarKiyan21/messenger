<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Floctopus.com</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{% url 'style.css' %}">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    </head>
    <body>
        <div class="messenger" id="chat">

            <div class="head-chat">
                <button class="close" type="button" data-dismiss="modal" aria-hidden="true">
                    <img src="../chats/img/close-button.png">
                </button>
            </div>

        </div>
        <div>
            <p><b>Ваше повідомлення:</b><br>
                <input id="message" type="text" size="40">
            </p>
            <p>
                <input id="button" type="submit" value="Отправить">
                <input type="reset" value="Очистить">
            </p>
        </div>
        <script
            src="http://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous">
        </script>
        <script>
            var channel = "private-5a65a1d874a8d";
            var uch = "private-5a65b573d5e5b";
            var socket = new WebSocket("ws://localhost:8000/" + uch);
            socket.onopen = function (event) {
                console.log(socket)
                $("#button").on("click", function(e) {
                    var message = $("#message").val();
                    var data = {
                        msg: message,
                        channel: channel,
                        uch: uch,
                    };
                    socket.send(JSON.stringify(data));
                    // $.post("http://localhost:8000/save/",{msg:message,channel:channel,uch:uch},function(r){},"json");
                });
                socket.onmessage = function (event) {
                    alert(event.data);
                }
            };
            socket.onerror = function (event) {
                console.log(event)
            }
            socket.onclose = function (event) {
                console.log(event)
            }

        </script>
    </body>
</html>